name: The Oubliette
map: |
  O.OOO
  O   O
   O  O
  OOOOOOOOO

player_start:
  pos: [0, 0, N]

exit:
  pos: [8, 3, E]
  to: res://levels/Melkor's Oubliette/sewers.yaml

doors:
  - { pos: [6, 3, E] }

things:
  - type: push
    pos: [0, 1, S]
    states:
      activated:
        - { action: remove_wall, pos: [1, 0] }
        - { action: play_sound, pos: [2, 0], param: scraping-stone.wav }

  - type: shelf
    pos: [1, 2, N]
    holds:
      - { id: iron-key }

  - type: key-hole
    pos: [5, 3, N]
    states:
      activated:
        - { action: check_in_hand, param: iron-key }
        - { action: remove_held_item }
        - { action: door, pos: [6, 3], param: open }

items:
  - { id: torch, pos: [0, 0, se] }
  - { id: rock, pos: [4, 1, se] }

wall_details:
  - pos: [0, 0, N]
    type: sign
    message: "You will never escape!\nYou will die down here in the oubliette!"
  - { type: pipe-hole, pos: [0, 0, W] }
  - { type: pipe-hole, pos: [0, 1, E] }
  - { type: crates, pos: [0, 3, N] }
  - { type: crates, pos: [2, 3, S] }
